# ============================================================================
# CARGO CONFIG - Cross-Platform Build Optimization
# ============================================================================
# For local dev: Fast incremental builds with system linker
# For CI/Release: Baseline CPU targets for maximum compatibility
# ============================================================================

[build]
jobs = 8

# ============================================================================
# macOS Intel - Use native linker for faster linking
# ============================================================================
[target.x86_64-apple-darwin]
rustflags = ["-C", "link-arg=-fuse-ld=/usr/bin/ld"]

# ============================================================================
# macOS Apple Silicon (M1/M2/M3) - Use native linker
# ============================================================================
[target.aarch64-apple-darwin]
rustflags = ["-C", "link-arg=-fuse-ld=/usr/bin/ld"]

# ============================================================================
# Windows x64 - Static CRT for standalone binary
# ============================================================================
[target.x86_64-pc-windows-msvc]
rustflags = ["-C", "link-arg=/INCREMENTAL:NO", "-C", "target-feature=+crt-static"]

# ============================================================================
# Linux x64 - LLD linker (faster in CI)
# ============================================================================
[target.x86_64-unknown-linux-gnu]
rustflags = ["-C", "link-arg=-fuse-ld=lld"]

# ============================================================================
# Linux ARM64 - LLD linker (ubuntu-24.04-arm runner)
# ============================================================================
[target.aarch64-unknown-linux-gnu]
rustflags = ["-C", "link-arg=-fuse-ld=lld"]

# ============================================================================
# Environment Variables
# ============================================================================
[env]
MACOSX_DEPLOYMENT_TARGET = "10.15"
